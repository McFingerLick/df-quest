import React, { useState } from 'react';
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';
import { Checkbox } from '@/components/ui/checkbox';
import { Input } from '@/components/ui/input';

const InventoryTracker = () => {
  const initialInventory = {
    common: [
      { name: 'Lithium Battery', required: 3 },
      { name: 'LED Light', required: 2 },
      { name: 'Printed Circuit Board', required: 3 },
    ],
    blue: [
      { name: 'Bucket of Paint', required: 5 },
      { name: 'Basic Ammo Production Part', required: 3 },
      { name: 'Intel Recorder', required: 1 },
      { name: 'Socket Adapter', required: 3 },
      { name: 'Military Power Bank', required: 3 },
      { name: 'Medical Alcohol', required: 3 },
      { name: 'Forehead Thermometer', required: 3 },
      { name: 'Gunpowder', required: 3 },
    ],
    purple: [
      { name: 'HiFi Sound Card', required: 3 },
      { name: 'Data Military Intel', required: 3 },
      { name: 'ASUS Motherboard', required: 3 },
      { name: 'Radio', required: 3 },
      { name: 'SSD', required: 6 },
      { name: 'RAM', required: 6 },
      { name: 'Ahsarah Specialty Flask', required: 1 },
      { name: 'Antler Wall Decoration', required: 2 },
      { name: 'Sarah Guard Confidential Files', required: 4 },
      { name: 'Blood Pressure Meter', required: 2 },
      { name: 'Ahsarah Glamour Hookah', required: 2 },
    ],
    gold: [
      { name: "Saeed's Pocket Watch", required: 1 },
      { name: 'Coffee', required: 2 },
      { name: 'SLR Camera', required: 2 },
      { name: 'Graphics Card', required: 1 },
      { name: 'Olivia Champagne', required: 1 },
      { name: 'Cell Phone', required: 2 },
      { name: 'CPU', required: 6 },
      { name: 'Merit Medal', required: 4 },
      { name: 'Ahsarah Specialty Wine Glass', required: 1 },
      { name: 'Shiny Pirate Gold Coin', required: 1 },
      { name: 'Military Explosive', required: 1 },
      { name: 'Pure Gold Lighter', required: 4 },
    ],
  };

  const [inventory, setInventory] = useState(() => {
    const stored = localStorage.getItem('inventory');
    if (stored) {
      return JSON.parse(stored);
    }
    return Object.keys(initialInventory).reduce((acc, category) => {
      acc[category] = initialInventory[category].map(item => ({
        ...item,
        current: 0,
        completed: false,
      }));
      return acc;
    }, {});
  });

  const handleCurrentChange = (category, index, value) => {
    const newInventory = { ...inventory };
    newInventory[category][index].current = Math.max(0, parseInt(value) || 0);
    newInventory[category][index].completed = 
      newInventory[category][index].current >= newInventory[category][index].required;
    localStorage.setItem('inventory', JSON.stringify(newInventory));
    setInventory(newInventory);
  };

  const handleCompletedToggle = (category, index) => {
    const newInventory = { ...inventory };
    newInventory[category][index].completed = !newInventory[category][index].completed;
    localStorage.setItem('inventory', JSON.stringify(newInventory));
    setInventory(newInventory);
  };

  const getCategoryColor = (category) => {
    switch(category) {
      case 'common': return 'bg-green-100';
      case 'blue': return 'bg-blue-100';
      case 'purple': return 'bg-purple-100';
      case 'gold': return 'bg-yellow-100';
      default: return 'bg-gray-100';
    }
  };

  const CategorySection = ({ category, items, color }) => (
    <Card className={`mb-6 ${color}`}>
      <CardHeader>
        <CardTitle className="capitalize">{category} Items</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="space-y-4">
          {items.map((item, index) => (
            <div key={item.name} className="flex items-center space-x-4">
              <Checkbox
                checked={item.completed}
                onCheckedChange={() => handleCompletedToggle(category, index)}
                className="h-5 w-5"
              />
              <div className="flex-1">
                <div className="font-medium">{item.name}</div>
                <div className="text-sm text-gray-500">
                  Required: {item.required}
                </div>
              </div>
              <Input
                type="number"
                value={item.current}
                onChange={(e) => handleCurrentChange(category, index, e.target.value)}
                className="w-20"
                min="0"
              />
              <div className={`w-20 text-center ${
                item.current >= item.required ? 'text-green-600' : 'text-gray-500'
              }`}>
                {item.current}/{item.required}
              </div>
            </div>
          ))}
        </div>
      </CardContent>
    </Card>
  );

  return (
    <div className="max-w-4xl mx-auto p-6">
      <h1 className="text-3xl font-bold mb-6">Zero Hour Inventory Tracker</h1>
      {Object.entries(inventory).map(([category, items]) => (
        <CategorySection
          key={category}
          category={category}
          items={items}
          color={getCategoryColor(category)}
        />
      ))}
    </div>
  );
};

export default InventoryTracker;
